From 3dca5a5c41f67a2e149582f3d46a09647b183e71 Mon Sep 17 00:00:00 2001
From: Paul B Mahol <onemda@gmail.com>
Date: Mon, 18 Aug 2014 11:00:24 +0000
Subject: [PATCH] wvdec: check for eof in wv_read_block_header()

Fixes Ticket #3865
Found-by: Piotr Bandurski <ami_stuff@o2.pl>
Signed-off-by: Paul B Mahol <onemda@gmail.com>
---
 libavformat/wvdec.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/libavformat/wvdec.c
+++ b/libavformat/wvdec.c
@@ -121,7 +121,7 @@
                    "Cannot determine additional parameters\n");
             return AVERROR_INVALIDDATA;
         }
-        while (avio_tell(pb) < block_end) {
+        while (avio_tell(pb) < block_end && !avio_feof(pb)) {
             int id, size;
             id   = avio_r8(pb);
             size = (id & 0x80) ? avio_rl24(pb) : avio_r8(pb);
