From: Markus Koschany <apo@debian.org>
Date: Sun, 30 Dec 2018 16:57:18 +0100
Subject: CVE-2017-9993

Origin: https://github.com/FFmpeg/FFmpeg/commit/a5d849b149ca67ced2d271dc84db0bc95a548abb
---
 libavformat/avidec.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/libavformat/avidec.c b/libavformat/avidec.c
index 928bbaa..713f822 100644
--- a/libavformat/avidec.c
+++ b/libavformat/avidec.c
@@ -870,6 +870,9 @@ static int read_gab2_sub(AVStream *st, AVPacket *pkt)
         if (!(sub_demuxer = av_probe_input_format2(&pd, 1, &score)))
             goto error;
 
+        if (strcmp(sub_demuxer->name, "srt") && strcmp(sub_demuxer->name, "ass"))
+            goto error;
+
         if (!(ast->sub_ctx = avformat_alloc_context()))
             goto error;
 
