From: Michael Niedermayer <michael@niedermayer.cc>
Date: Mon, 13 Jul 2015 13:46:10 +0000 (+0200)
Subject: avcodec/alac: Clear pointers in allocate_buffers()
X-Git-Tag: n2.8~1073
X-Git-Url: http://git.videolan.org/?p=ffmpeg.git;a=commitdiff_plain;h=f7068bf277a37479aecde2832208d820682b35e6

avcodec/alac: Clear pointers in allocate_buffers()

Fixes: 06a4edb39ad8a9883175f9bd428334a2_signal_sigsegv_7ffff713351a_706_mov__alac__ALAC_6ch.mov

Found-by: Samuel Gro√ü, Mateusz "j00ru" Jurczyk and Gynvael Coldwind
Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
---

--- a/libavcodec/alac.c
+++ b/libavcodec/alac.c
@@ -482,6 +482,12 @@
     int ch;
     int buf_size = alac->max_samples_per_frame * sizeof(int32_t);
 
+    for (ch = 0; ch < 2; ch++) {
+        alac->predict_error_buffer[ch]  = NULL;
+        alac->output_samples_buffer[ch] = NULL;
+        alac->extra_bits_buffer[ch]     = NULL;
+    }
+
     for (ch = 0; ch < FFMIN(alac->channels, 2); ch++) {
         FF_ALLOC_OR_GOTO(alac->avctx, alac->predict_error_buffer[ch],
                          buf_size, buf_alloc_fail);
