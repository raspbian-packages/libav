From f077ad69c682c13ab75a72aec11a61cac53f0c91 Mon Sep 17 00:00:00 2001
From: Carl Eugen Hoyos <cehoyos@ag.or.at>
Date: Sun, 4 Sep 2016 21:11:02 +0200
Subject: [PATCH] lavc/avpacket: Fix undefined behaviour, do not pass a null
 pointer to memcpy().

Fixes ticket #5128.
---
 libavcodec/avpacket.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

--- a/libavcodec/avpacket.c
+++ b/libavcodec/avpacket.c
@@ -364,7 +364,8 @@
         ret = packet_alloc(&dst->buf, src->size);
         if (ret < 0)
             goto fail;
-        memcpy(dst->buf->data, src->data, src->size);
+        if (src->size)
+            memcpy(dst->buf->data, src->data, src->size);
 
         dst->data = dst->buf->data;
     } else {
